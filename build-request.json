{
  "kind": "build_request",
  "title": "Fix Groq API Key integration and error handling in AI Chat",
  "projectName": "Wrapper AI",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Fix the Groq API integration in `frontend/src/hooks/useChat.ts` so that when a user enters a valid API key in the app, it is correctly read, stored, and passed as the Authorization header in all Groq API requests (e.g., `Authorization: Bearer <key>`). Ensure no extra whitespace or formatting issues corrupt the key value.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2",
          "msg-3"
        ],
        "quotes": [
          "First message sa he",
          "Yes",
          "Groq API Key integration को properly fix करना"
        ]
      },
      "acceptanceCriteria": [
        "Entering a valid Groq API key in the app and sending the first message does not produce an 'Invalid API Key' or 401 error",
        "The Authorization header sent to Groq API is correctly formatted as 'Bearer <key>' with no extra spaces",
        "The API key is trimmed of any leading/trailing whitespace before use"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Update `frontend/.env` to remove or replace the currently hardcoded (and potentially expired/revoked) `VITE_GROQ_API_KEY` value with a placeholder, and ensure the app reads the API key from user input at runtime rather than relying solely on the environment variable.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2"
        ],
        "quotes": [
          "Ea new ha",
          "app में API Key directly enter करने के बाद भी error आ रही है"
        ]
      },
      "acceptanceCriteria": [
        "The hardcoded Groq API key in frontend/.env is replaced with a placeholder or empty value",
        "The app correctly uses the API key entered by the user in the input field, giving it priority over the environment variable",
        "If no key is stored, the user is prompted to enter one"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Improve error handling in the chat feature (`frontend/src/hooks/useChat.ts` and `frontend/src/pages/AIChatScreen.tsx`) to display clear, actionable error messages when the Groq API returns authentication errors (401), rate limit errors (429), or network failures. Show distinct messages for 'Invalid API Key', 'Rate limit exceeded', and 'Network error'.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2",
          "msg-3"
        ],
        "quotes": [
          "Error handling को बेहतर बनाना ताकि सही error message दिखे",
          "API Key validation को improve करना"
        ]
      },
      "acceptanceCriteria": [
        "When the Groq API returns a 401 error, the UI shows a message like 'Invalid API Key. Please check your key and try again.'",
        "When the API returns a 429 error, the UI shows a rate limit message",
        "Network errors are caught and shown to the user with a friendly message",
        "Errors are displayed inline in the chat UI, not just in the console"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Add client-side validation for the Groq API key input field: validate that the key starts with 'gsk_' and has a minimum length before allowing the user to save it. Show an inline validation error if the format is incorrect.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-2",
          "msg-3"
        ],
        "quotes": [
          "API Key validation को improve करना"
        ]
      },
      "acceptanceCriteria": [
        "The API key input field validates that the value starts with 'gsk_'",
        "If the key format is invalid, an inline error message is shown before allowing submission",
        "A valid key passes validation and is saved without error"
      ]
    }
  ],
  "constraints": [
    "Do not log or expose the Groq API key in the browser console or any UI element",
    "Do not share or hardcode any real API key in source files",
    "Preserve existing coin-deduction logic in useChat.ts"
  ],
  "nonGoals": [
    "Changing the UI language to Hindi",
    "Replacing Groq with another AI provider",
    "Modifying backend Motoko code"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}